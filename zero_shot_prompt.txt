function toSnakeCase(text) {
    return text
        .toLowerCase() // Convert to lowercase
        .replace(/\s+/g, '_') // Replace spaces with underscores
        .replace(/[^\w-]+/g, '') // Remove all non-word characters
        .replace(/--+/g, '_') // Replace multiple underscores with a single underscore
        .trim(); // Trim leading and trailing underscores
}

// Example usage
console.log(toSnakeCase("Hello World! This is a Test.")); // Output: hello_world_this_is_a_test